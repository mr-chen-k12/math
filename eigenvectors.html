<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eigenvalue Mental Math Trainer</title>
    <style>
        :root {
            --bg-color: #f0f2f5;
            --card-bg: #ffffff;
            --primary: #2563eb;
            --success: #22c55e;
            --error: #ef4444;
            --text: #1f2937;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background-color: var(--bg-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            color: var(--text);
        }

        .container {
            background: var(--card-bg);
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            text-align: center;
            max-width: 400px;
            width: 90%;
        }

        h1 {
            margin-top: 0;
            font-size: 1.5rem;
            color: var(--text);
        }

        .stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1.5rem;
            font-size: 0.9rem;
            color: #6b7280;
        }

        /* Matrix Styling */
        .matrix-container {
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Times New Roman', serif;
            font-size: 2rem;
            margin: 2rem 0;
        }

        .matrix-label {
            margin-right: 10px;
            font-style: italic;
        }

        .matrix {
            position: relative;
            padding: 0 10px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px 20px;
            text-align: center;
        }

        /* The Brackets */
        .matrix::before, .matrix::after {
            content: "";
            position: absolute;
            top: 0;
            bottom: 0;
            width: 8px;
            border: 2px solid var(--text);
        }

        .matrix::before {
            left: 0;
            border-right: none;
            border-top-left-radius: 8px;
            border-bottom-left-radius: 8px;
        }

        .matrix::after {
            right: 0;
            border-left: none;
            border-top-right-radius: 8px;
            border-bottom-right-radius: 8px;
        }

        /* Inputs */
        .input-group {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .lambda-row {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 1.2rem;
        }

        input[type="number"] {
            width: 60px;
            padding: 8px;
            font-size: 1.1rem;
            text-align: center;
            border: 2px solid #e5e7eb;
            border-radius: 6px;
            outline: none;
            transition: border-color 0.2s;
        }

        input[type="number"]:focus {
            border-color: var(--primary);
        }

        /* Buttons */
        .btn-group {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        button {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: opacity 0.2s;
        }

        button:active {
            transform: translateY(1px);
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-secondary {
            background-color: #e5e7eb;
            color: var(--text);
        }

        .message {
            margin-top: 1rem;
            min-height: 1.5em;
            font-weight: 600;
        }

        .correct { color: var(--success); }
        .incorrect { color: var(--error); }

        .hint {
            margin-top: 10px;
            font-size: 0.85rem;
            color: #6b7280;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>Eigenvalue Trainer</h1>
    
    <div class="stats">
        <span>Streak: <strong id="streak">0</strong></span>
        <span>High Score: <strong id="highScore">0</strong></span>
    </div>

    <div class="matrix-container">
        <span class="matrix-label">A = </span>
        <div class="matrix" id="matrixDisplay">
            <div>0</div><div>0</div>
            <div>0</div><div>0</div>
        </div>
    </div>

    <div class="input-group">
        <div class="lambda-row">
            <span>&lambda;<sub>1</sub> =</span>
            <input type="number" id="ans1" placeholder="?">
        </div>
        <div class="lambda-row">
            <span>&lambda;<sub>2</sub> =</span>
            <input type="number" id="ans2" placeholder="?">
        </div>
    </div>

    <div class="btn-group">
        <button class="btn-primary" onclick="checkAnswer()">Check</button>
        <button class="btn-secondary" onclick="newProblem()">Skip / New</button>
    </div>

    <div class="message" id="message"></div>
    <div class="hint">Hint: &lambda;<sub>1</sub> + &lambda;<sub>2</sub> = Trace(A)</div>
</div>

<script>
    let currentEigenvalues = [];
    let streak = 0;
    let highScore = 0;

    // Helper to get factors of a number (including negative factors)
    function getFactors(n) {
        if (n === 0) return [0]; 
        const factors = [];
        const absN = Math.abs(n);
        for (let i = 1; i <= Math.sqrt(absN); i++) {
            if (n % i === 0) {
                factors.push(i);
                factors.push(-i);
                if (i !== n/i) {
                    factors.push(n/i);
                    factors.push(-(n/i));
                }
            }
        }
        return factors;
    }

    function getRandomInt(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    function generateMatrix() {
        // 1. Pick two small integer eigenvalues (-6 to 6)
        // We avoid 0 just to keep it interesting, though 0 is valid.
        let l1 = getRandomInt(-6, 6);
        let l2 = getRandomInt(-6, 6);
        
        currentEigenvalues = [l1, l2].sort((a, b) => a - b);

        const trace = l1 + l2;     // a + d
        const det = l1 * l2;       // ad - bc

        // 2. Construct matrix entries
        // We need integers a, b, c, d such that:
        // a + d = trace
        // ad - bc = det  =>  bc = ad - det
        
        // Pick 'a' randomly near the trace to keep numbers small
        let a = getRandomInt(Math.min(l1, l2) - 2, Math.max(l1, l2) + 2);
        let d = trace - a;

        let targetBC = (a * d) - det;

        let b, c;

        if (targetBC === 0) {
            // If ad == det, then bc must be 0.
            // Randomly assign one to be 0 and the other to be a small random int.
            if (Math.random() > 0.5) {
                b = 0;
                c = getRandomInt(-5, 5);
            } else {
                c = 0;
                b = getRandomInt(-5, 5);
            }
        } else {
            // Find factors of targetBC to get integer b and c
            const factors = getFactors(targetBC);
            // Pick a random factor for b
            b = factors[getRandomInt(0, factors.length - 1)];
            c = targetBC / b;
        }

        // Render to DOM
        const matrixDiv = document.getElementById('matrixDisplay');
        matrixDiv.innerHTML = `
            <div>${a}</div><div>${b}</div>
            <div>${c}</div><div>${d}</div>
        `;

        // Clear inputs and messages
        document.getElementById('ans1').value = '';
        document.getElementById('ans2').value = '';
        document.getElementById('message').textContent = '';
        document.getElementById('message').className = 'message';
        document.getElementById('ans1').focus();
    }

    function checkAnswer() {
        const i1 = parseInt(document.getElementById('ans1').value);
        const i2 = parseInt(document.getElementById('ans2').value);
        const msg = document.getElementById('message');

        if (isNaN(i1) || isNaN(i2)) {
            msg.textContent = "Please enter both values.";
            msg.className = "message incorrect";
            return;
        }

        const userAns = [i1, i2].sort((a, b) => a - b);
        
        if (userAns[0] === currentEigenvalues[0] && userAns[1] === currentEigenvalues[1]) {
            msg.textContent = "Correct! Great work.";
            msg.className = "message correct";
            
            streak++;
            if(streak > highScore) highScore = streak;
            updateStats();
            
            // Auto generate new problem after short delay
            setTimeout(() => {
                newProblem();
            }, 1000);
        } else {
            streak = 0;
            updateStats();
            msg.textContent = `Incorrect. Try checking the Trace (${currentEigenvalues[0] + currentEigenvalues[1]}) and Determinant.`;
            msg.className = "message incorrect";
        }
    }

    function newProblem() {
        generateMatrix();
    }

    function updateStats() {
        document.getElementById('streak').innerText = streak;
        document.getElementById('highScore').innerText = highScore;
    }

    // Allow Enter key to submit
    document.addEventListener('keypress', function (e) {
        if (e.key === 'Enter') {
            checkAnswer();
        }
    });

    // Initial load
    generateMatrix();

</script>

</body>
</html>
